<style>
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideDown {
    from {
      transform: translateY(-20px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  .dropdown-item {
    animation: fadeInUp 0.3s ease forwards;
  }

  #navbar {
    background-color: rgb(22 101 52) !important; /* Tambahkan !important */
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    height: 96px;
  }

  .dark #navbar {
    background-color: rgb(17 24 39) !important; /* Tambahkan !important */
  }

  #navbar.scrolled {
    backdrop-filter: blur(8px);
    background-color: rgba(22, 101, 52, 0.9) !important; /* Tambahkan !important */
    height: 80px;
    box-shadow: 0 2px 15px rgba(0,0,0,0.15);
  }

  .dark #navbar.scrolled {
    background-color: rgba(17, 24, 39, 0.9) !important; /* Tambahkan !important */
  }

  #mobile-menu {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background-color: rgb(22 101 52);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    max-height: 0;
    overflow-y: auto;
    opacity: 0;
    transform: translateY(-10px);
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
  }

  .dark #mobile-menu {
    background: rgb(17 24 39);
  }

  #mobile-menu.show {
    display: block;
    max-height: 80vh;
    opacity: 1;
    transform: translateY(0);
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }

  .hamburger-icon {
    position: relative;
    width: 24px;
    height: 24px;
    transition: transform 0.3s ease;
  }

  .hamburger-line {
    position: absolute;
    width: 100%;
    height: 2px;
    background-color: white;
    transition: all 0.3s ease;
    border-radius: 2px;
  }

  .hamburger-line:nth-child(1) {
    top: 6px;
  }

  .hamburger-line:nth-child(2) {
    top: 12px;
  }

  .hamburger-line:nth-child(3) {
    top: 18px;
  }

  .hamburger-icon.active .hamburger-line:nth-child(1) {
    transform: rotate(45deg);
    top: 12px;
  }

  .hamburger-icon.active .hamburger-line:nth-child(2) {
    opacity: 0;
  }

  .hamburger-icon.active .hamburger-line:nth-child(3) {
    transform: rotate(-45deg);
    top: 12px;
  }

  #mobile-menu::-webkit-scrollbar {
    display: none;
  }

  #mobile-menu {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  @media (min-width: 1024px) {
    #mobile-menu {
      display: none !important;
    }
  }

  .arrow-icon {
    display: inline-block;
    transition: transform 0.3s ease;
  }

  .arrow-down .arrow-icon {
    transform: rotate(180deg);
  }

  .dropdown-menu {
    max-height: 300px;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: rgba(156, 163, 175, 0.5) transparent;
    background: rgba(255, 255, 255, 0.98);
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    animation: slideDown 0.3s ease forwards;
  }

  .dropdown-menu::-webkit-scrollbar {
    width: 6px;
  }

  .dropdown-menu::-webkit-scrollbar-track {
    background: transparent;
  }

  .dropdown-menu::-webkit-scrollbar-thumb {
    background-color: rgba(156, 163, 175, 0.5);
    border-radius: 3px;
  }

  .nav-link {
    position: relative;
    transition: all 0.3s ease;
  }

  .nav-link:after {
    content: '';
    position: absolute;
    width: 0;
    height: 2px;
    bottom: -4px;
    left: 50%;
    background-color: #FCD34D;
    transition: all 0.3s ease;
    transform: translateX(-50%);
  }

  .nav-link:hover:after {
    width: 100%;
  }

  .logo-container {
    transition: transform 0.3s ease;
  }

  .logo-container:hover {
    transform: scale(1.05);
  }

  .theme-toggle {
    transition: transform 0.3s ease;
  }

  .theme-toggle:hover {
    transform: rotate(180deg);
  }

  /* Tambahan style untuk dropdown desktop */
  .desktop-dropdown {
    position: relative;
  }

  .desktop-dropdown-content {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    background-color: rgb(22 101 52);
    min-width: 200px;
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    border-radius: 8px;
    z-index: 1000;
  }

  .dark .desktop-dropdown-content {
    background-color: rgb(17 24 39);
  }

  .desktop-dropdown:hover .desktop-dropdown-content {
    display: block;
    animation: fadeInUp 0.3s ease forwards;
  }

  .desktop-dropdown-item {
    padding: 12px 16px;
    color: white;
    display: block;
    text-decoration: none;
    transition: all 0.3s ease;
  }

  .desktop-dropdown-item:hover {
    background-color: rgba(255, 255, 255, 0.1);
  }
</style>

<nav class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 mb-10 flex items-center justify-center" id="navbar">
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between h-16">
      
      <!-- Logo & Title -->
      <div class="logo-container">
        <a href="{{ absURL "/" }}" class="flex items-center">
          {{ if .Site.Params.logo }}
          <img src='{{ absURL "/" }}kalbar-logo.png' alt="{{ .Site.Title }}" class="h-28 w-12" />
          {{ end }}
          <span class="ml-4 text-md font-medium text-white hover:text-yellow-300 dark:hover:text-yellow-400 dark:text-yellow-500 leading-tight transition-colors duration-300">
            Dinas Perkebunan dan Peternakan<br/>
            Provinsi Kalimantan Barat
          </span>
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <div class="lg:hidden flex items-center">
        <button id="theme-toggle-mobile" class="theme-toggle p-2 text-white hover:text-yellow-400 transition-all duration-300">
          <div id="theme-icon-mobile">
            <svg class="bulan w-6 h-6 text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" style="background: transparent;"><path fill-rule="evenodd" d="M11.675 2.015a.998.998 0 0 0-.403.011C6.09 2.4 2 6.722 2 12c0 5.523 4.477 10 10 10 4.356 0 8.058-2.784 9.43-6.667a1 1 0 0 0-1.02-1.33c-.08.006-.105.005-.127.005h-.001l-.028-.002A5.227 5.227 0 0 0 20 14a8 8 0 0 1-8-8c0-.952.121-1.752.404-2.558a.996.996 0 0 0 .096-.428V3a1 1 0 0 0-.825-.985Z" clip-rule="evenodd"/></svg>
          </div>
        </button>
        <button class="text-white focus:outline-none transition-transform duration-300 ease-in-out transform hover:scale-105" id="mobile-menu-button" aria-label="Menu">
          <div class="hamburger-icon transition-all duration-300 ease-in-out">
            <span class="hamburger-line transition-all duration-300"></span>
            <span class="hamburger-line transition-all duration-300"></span>
            <span class="hamburger-line transition-all duration-300"></span>
          </div>
        </button>
      </div>

      <!-- Desktop Menu -->
      <div class="hidden lg:flex lg:items-center lg:space-x-6">
        {{ range .Site.Menus.main }}
        <div class="desktop-dropdown">
          <button class="nav-link px-3 py-2 text-white hover:text-yellow-300 transition-all duration-300 flex items-center text-sm">
            {{ .Name }}
            <svg class="arrow-icon w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          
          <div class="desktop-dropdown-content">
            {{ if .HasChildren }}
              {{ range .Children }}
              <a href="{{ .URL }}" class="desktop-dropdown-item">{{ .Name }}</a>
              {{ end }}
            {{ else }}
              <a href="{{ .URL }}" class="desktop-dropdown-item">{{ .Name }}</a>
            {{ end }}
          </div>
        </div>
        {{ end }}

        <!-- Theme Toggle -->
        <button id="theme-toggle" class="theme-toggle p-2 text-white hover:text-yellow-400 transition-all duration-300">
          <div id="theme-icon">
           <svg class="bulan w-6 h-6 text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" style="background: transparent;"><path fill-rule="evenodd" d="M11.675 2.015a.998.998 0 0 0-.403.011C6.09 2.4 2 6.722 2 12c0 5.523 4.477 10 10 10 4.356 0 8.058-2.784 9.43-6.667a1 1 0 0 0-1.02-1.33c-.08.006-.105.005-.127.005h-.001l-.028-.002A5.227 5.227 0 0 0 20 14a8 8 0 0 1-8-8c0-.952.121-1.752.404-2.558a.996.996 0 0 0 .096-.428V3a1 1 0 0 0-.825-.985Z" clip-rule="evenodd"/></svg>
          </div>
        </button>
      </div>

    </div>
  </div>

  <!-- Mobile Menu -->
  <div class="lg:hidden transition-all duration-300 ease-in-out transform origin-top" id="mobile-menu">
    <div class="px-2 pt-2 pb-3 space-y-1">
      {{ range .Site.Menus.main }}
      <div class="mobile-dropdown">
        {{ if .HasChildren }}
        <button class="w-full text-left px-3 py-2 text-white hover:bg-green-700 dark:hover:bg-gray-700 rounded-md flex items-center justify-between text-sm transition-colors duration-200">
          {{ .Name }}
          <svg class="arrow-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </button>
        <div class="hidden pl-4 space-y-1 transition-all duration-300 ease-in-out">
          {{ range .Children }}
          <button onclick="handleMenuClick('{{ .URL }}')" class="block w-full text-left px-3 py-2 text-white hover:bg-green-700 dark:hover:bg-gray-700 rounded-md text-sm transition-colors duration-200">{{ .Name }}</button>
          {{ end }}
        </div>
        {{ else }}
        <button onclick="handleMenuClick('{{ .URL }}')" class="block w-full text-left px-3 py-2 text-white hover:bg-green-700 dark:hover:bg-gray-700 rounded-md text-sm transition-colors duration-200">
          {{ .Name }}
        </button>
        {{ end }}
      </div>
      {{ end }}
    </div>
  </div>
</nav>

<script>
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  const hamburgerIcon = document.querySelector('.hamburger-icon');

  mobileMenuButton.addEventListener('click', () => {
    mobileMenu.classList.toggle('show');
    hamburgerIcon.classList.toggle('active');
  });

  // Mobile dropdowns
  let openDropdown = null;
  document.querySelectorAll('.mobile-dropdown > button').forEach(button => {
    button.addEventListener('click', (e) => {
      e.preventDefault();
      const dropdown = button.nextElementSibling;
      
      if (openDropdown && openDropdown !== dropdown) {
        openDropdown.classList.add('hidden');
        openDropdown.previousElementSibling.classList.remove('arrow-down');
      }
      
      button.classList.toggle('arrow-down');
      if (dropdown) {
        dropdown.classList.toggle('hidden');
        if (!dropdown.classList.contains('hidden')) {
          openDropdown = dropdown;
        } else {
          openDropdown = null;
        }
      }
    });
  });

  function handleMenuClick(url) {
    if (url.startsWith('http')) {
      window.open(url, '_blank');
    } else {
      window.location.href = url;
    }
  }

  const navbar = document.getElementById('navbar');
  window.addEventListener('scroll', () => {
    if (window.scrollY > 50) {
      navbar.classList.add('scrolled');
    } else {
      navbar.classList.remove('scrolled');
    }
  });

  const themeToggle = document.getElementById('theme-toggle');
  const themeToggleMobile = document.getElementById('theme-toggle-mobile');
  const themeIcon = document.getElementById('theme-icon');
  const themeIconMobile = document.getElementById('theme-icon-mobile');
  const html = document.documentElement;
  
  const savedTheme = localStorage.getItem('theme') || 'light';
  if (savedTheme === 'dark') {
    html.classList.add('dark');
    navbar.classList.add('dark');
  } else {
    html.classList.remove('dark');
    navbar.classList.remove('dark');
  }

  function toggleTheme() {
    document.documentElement.classList.toggle('dark');
      
    if (document.documentElement.classList.contains('dark')) {
      const sunIcon = '<svg class="matahari w-6 h-6 text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" style="background: transparent;"><path fill-rule="evenodd" d="M13 3a1 1 0 1 0-2 0v2a1 1 0 1 0 2 0V3ZM6.343 4.929A1 1 0 0 0 4.93 6.343l1.414 1.414a1 1 0 0 0 1.414-1.414L6.343 4.929Zm12.728 1.414a1 1 0 0 0-1.414-1.414l-1.414 1.414a1 1 0 0 0 1.414 1.414l1.414-1.414ZM12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10Zm-9 4a1 1 0 1 0 0 2h2a1 1 0 1 0 0-2H3Zm16 0a1 1 0 1 0 0 2h2a1 1 0 1 0 0-2h-2ZM7.757 17.657a1 1 0 1 0-1.414-1.414l-1.414 1.414a1 1 0 1 0 1.414 1.414l1.414-1.414Zm9.9-1.414a1 1 0 0 0-1.414 1.414l1.414 1.414a1 1 0 0 0 1.414-1.414l-1.414-1.414ZM13 19a1 1 0 1 0-2 0v2a1 1 0 1 0 2 0v-2Z" clip-rule="evenodd"/></svg>';
      themeIcon.innerHTML = sunIcon;
      themeIconMobile.innerHTML = sunIcon;
      navbar.classList.add('dark');
      localStorage.setItem('theme', 'dark');
    } else {
      const moonIcon = '<svg class="bulan w-6 h-6 text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" style="background: transparent;"><path fill-rule="evenodd" d="M11.675 2.015a.998.998 0 0 0-.403.011C6.09 2.4 2 6.722 2 12c0 5.523 4.477 10 10 10 4.356 0 8.058-2.784 9.43-6.667a1 1 0 0 0-1.02-1.33c-.08.006-.105.005-.127.005h-.001l-.028-.002A5.227 5.227 0 0 0 20 14a8 8 0 0 1-8-8c0-.952.121-1.752.404-2.558a.996.996 0 0 0 .096-.428V3a1 1 0 0 0-.825-.985Z" clip-rule="evenodd"/></svg>';
      themeIcon.innerHTML = moonIcon;
      themeIconMobile.innerHTML = moonIcon;
      navbar.classList.remove('dark');
      localStorage.setItem('theme', 'light');
    }
  }

  themeToggle.addEventListener('click', toggleTheme);
  themeToggleMobile.addEventListener('click', toggleTheme);
</script>
