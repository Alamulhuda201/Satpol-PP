{{ define "main" }}
<div class="main-container ">
  <!-- Sidebar -->
  <aside class="sidebar">
    <ul class="sidebar-menu">
      <li><a href="#profil" class="menu-link" data-scroll>Profil Singkat</a></li>
      <li><a href="#tugas" class="menu-link" data-scroll>Tugas PPID</a></li>
      <li><a href="#fungsi" class="menu-link" data-scroll>Fungsi PPID</a></li>
      <li><a href="#" class="menu-link struktur-link" onclick="openImageModal('{{ .Params.link_struktur }}')">Struktur PPID Satpol PP Prov. Kalbar</a></li>
    </ul>
  </aside>

  <!-- Main Content -->
  <div >
    <!-- Profil Section -->
    <div class="container" id="profil">
      <h1 class="title text-center">{{ .Title }}</h1>
      <div class="description">
        {{ .Content }}
      </div>
    </div>

    <!-- Tugas Section -->
    <div class="container" id="tugas">
      <h2 class="section-title">Tugas PPID:</h2>
      <ol class="task-list">
        {{ range .Params.tugas }}
        <li>{{ . }}</li>
        {{ end }}
      </ol>
    </div>

    <!-- Fungsi Section -->
    <div class="container" id="fungsi">
      <h2 class="section-title">Fungsi PPID:</h2>
      <ol class="function-list">
        {{ range .Params.fungsi }}
        <li>{{ . }}</li>
        {{ end }}
      </ol>
    </div>
  </div>
</div>

<!-- Image Modal -->
<div id="imageModal" class="fixed inset-0 bg-black bg-opacity-75 hidden z-50 flex items-center justify-center">
  <div class="relative max-w-[90vw] max-h-[90vh]">
    <img id="modalImage" src="" alt="Struktur PPID" class="max-h-[90vh] max-w-[90vw] object-contain">
    <button onclick="closeImageModal()" class="absolute top-4 right-4 text-white bg-red-600 rounded-full p-2 hover:bg-red-700">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  </div>
</div>

<!-- Styling -->
<style>
  html {
    scroll-behavior: smooth;
    scroll-padding-top: 120px; /* Menambahkan padding atas untuk scroll */
  }

  .main-container {
    display: flex;
    max-width: 1400px;
    margin: 50px auto;
    padding: 20px;
    gap: 30px;
    background: #F2F2F2;
    margin-top: 150px;
  }

  .sidebar {
    width: 25%;
    position: sticky;
    top: 20px;
    height: fit-content;
    background: #F6F6F6;
    padding: 20px;
    border-radius: 12px;
    /* box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); */
    border: 1px solid #D3D3D3;
    transition: all 0.3s ease;
  }

  .sidebar:hover {
    transform: translateY(-5px);
    border: 1px solid #D3D3D3;
  }

  .sidebar-menu {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .sidebar-menu li {
    margin-bottom: 15px;
  }

  .menu-link {
    display: block;
    text-decoration: none;
    color: #03A055;
    font-weight: 600;
    padding: 10px 15px;
    border-radius: 8px;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    background: transparent;
  }

  .menu-link:before {
    content: '';
    position: absolute;
    left: 0;
    bottom: 0;
    height: 2px;
    width: 0;
    background: #03A055;
    transition: width 0.3s ease;
  }

  .struktur-link {
    position: relative;
    transition: all 0.3s ease;
    animation: pulse 2s infinite;
  }

  .struktur-link:hover {
    transform: scale(1.05);
    background: #03A055;
    color: white;
    box-shadow: 0 5px 15px rgba(3, 160, 85, 0.3);
  }

  @keyframes pulse {
    0% {
      box-shadow: 0 0 0 0 rgba(3, 160, 85, 0.4);
    }
    70% {
      box-shadow: 0 0 0 10px rgba(3, 160, 85, 0);
    }
    100% {
      box-shadow: 0 0 0 0 rgba(3, 160, 85, 0);
    }
  }

  @keyframes openFile {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    50% {
      transform: scale(1.2) rotate(5deg);
      opacity: 0.8;
    }
    100% {
      transform: scale(0) rotate(15deg);
      opacity: 0;
    }
  }

  .menu-link:hover:before {
    width: 100%;
  }

  .title {
    color: #03A055;
    font-size: 2em;
    margin-bottom: 20px;
  }

  .section-title {
    color: #2D3748;
    font-size: 1.5em;
    margin: 30px 0 15px;
    border-bottom: 2px solid #03A055;
    padding-bottom: 8px;
  }

  .task-list, .function-list {
    list-style-type: decimal;
    padding-left: 25px;
    margin: 0;
  }

  .task-list li, .function-list li {
    position: relative;
    padding-left: 10px;
    margin-bottom: 12px;
  }

  section {
    scroll-margin-top: 2rem;
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Add smooth scrolling to menu links
  document.querySelectorAll('a[data-scroll]').forEach(anchor => {
    anchor.addEventListener('click', function(e) {
      e.preventDefault();
      const targetId = this.getAttribute('href');
      const targetElement = document.querySelector(targetId);
      const offset = 120; // Offset yang sama dengan scroll-padding-top
      
      if (targetElement) {
        const elementPosition = targetElement.getBoundingClientRect().top;
        const offsetPosition = elementPosition + window.pageYOffset - offset;
        
        window.scrollTo({
          top: offsetPosition,
          behavior: 'smooth'
        });
      }
    });
  });
});

function openImageModal(src) {
  const modal = document.getElementById('imageModal');
  const modalImage = document.getElementById('modalImage');
  modalImage.src = src;
  modal.classList.remove('hidden');

  // Add zoom and pan functionality
  let scale = 1;
  let isDragging = false;
  let startX, startY, translateX = 0, translateY = 0;

  modalImage.addEventListener('wheel', (e) => {
    e.preventDefault();
    const delta = e.deltaY * -0.01;
    scale = Math.min(Math.max(0.5, scale + delta), 4);
    modalImage.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
  });

  modalImage.addEventListener('mousedown', (e) => {
    isDragging = true;
    startX = e.clientX - translateX;
    startY = e.clientY - translateY;
  });

  modalImage.addEventListener('mousemove', (e) => {
    if (isDragging) {
      translateX = e.clientX - startX;
      translateY = e.clientY - startY;
      modalImage.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
    }
  });

  modalImage.addEventListener('mouseup', () => {
    isDragging = false;
  });

  modalImage.addEventListener('dblclick', () => {
    scale = 1;
    translateX = 0;
    translateY = 0;
    modalImage.style.transform = 'translate(0px, 0px) scale(1)';
  });
}

function closeImageModal() {
  const modal = document.getElementById('imageModal');
  const modalImage = document.getElementById('modalImage');
  modal.classList.add('hidden');
  modalImage.style.transform = 'translate(0px, 0px) scale(1)';
}

// Close modal when clicking outside the image
document.getElementById('imageModal').addEventListener('click', (e) => {
  if (e.target === document.getElementById('imageModal')) {
    closeImageModal();
  }
});
</script>
{{ end }}
